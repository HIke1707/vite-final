import{c as C,e as x,l as j,g as _,o as i,a as m,b as e,F as S,r as N,t as d,d as U,h as o,w as T,k as $,f as q,n as u,p as M,v as L}from"./index-3to8NFAF.js";import{u as B}from"./cartStores-dhNOTVs4.js";import{a as E}from"./axios-G2rPRu76.js";import{u as F}from"./toastMessage-0GFOzgRD.js";const D={class:"container"},O=$('<div class="row justify-content-center"><div class="col-md-10"><nav class="navbar navbar-expand-lg navbar-light px-0"><a class="navbar-brand" href="./index.html">Checkout</a><ul class="list-unstyled mb-0 ms-md-auto d-flex align-items-center justify-content-between justify-content-md-end w-100 mt-md-0 mt-4"><li class="me-md-6 me-3 position-relative custom-step-line"><i class="fas fa-check-circle d-md-inline d-block text-center"></i> <span class="text-nowrap">Lorem ipsum</span></li><li class="me-md-6 me-3 position-relative custom-step-line"><i class="fas fa-check-circle d-md-inline d-block text-center"></i> <span class="text-nowrap">Lorem ipsum</span></li><li><i class="fas fa-dot-circle d-md-inline d-block text-center"></i> <span class="text-nowrap">Lorem ipsum</span></li></ul></nav></div></div><div class="row justify-content-center"><div class="col-md-10"><h3 class="fw-bold mb-4 pt-3">Checkout</h3></div></div>',2),P={class:"row flex-row-reverse justify-content-center pb-5"},R={class:"col-md-4"},z={class:"border p-4 mb-4"},I=["src"],A={class:"w-100"},G={class:"d-flex justify-content-between"},H={class:"mb-0 fw-bold"},J={class:"mb-0"},K={class:"mb-0 fw-bold"},Q={class:"table mt-4 border-top border-bottom text-muted"},W=e("th",{scope:"row",class:"border-0 px-0 pt-4 font-weight-normal"},"total",-1),X={class:"text-end border-0 px-0 pt-4"},Y={colspan:"2"},Z={key:0},ee=e("span",null,"已套用優惠券",-1),se={class:"color-danger"},te={class:"d-flex justify-content-between mt-4"},ae=e("p",{class:"mb-0 h4 fw-bold"},"Total",-1),le={class:"mb-0 h4 fw-bold"},oe={class:"col-md-6"},ne=e("p",null,"Contact information",-1),ce={class:"mb-0"},de=e("label",{for:"email",class:"form-label"},"Email",-1),re=e("p",{class:"mt-4"},"Shipping address",-1),ie={class:"mb-2"},me=e("label",{for:"name",class:"form-label"},"收件人姓名",-1),ue={class:"mb-2"},pe=e("label",{for:"tel",class:"form-label"},"收件人電話",-1),_e={class:"mb-2"},ve=e("label",{for:"address",class:"form-label"},"收件人地址",-1),fe={class:"mb-3"},be=e("label",{for:"message",class:"form-label"},"留言",-1),he=e("div",{class:"text-end"},[e("button",{type:"submit",class:"btn btn-danger"},"送出訂單")],-1),Ve={__name:"OrderPage",setup(xe){const g=F(),{pushMessage:v}=g,w="https://ec-course-api.hexschool.io/v2",y="yangapi",p=B(),c=C({get(){return p.cart}}),t=x({user:{name:"",email:"",tel:"",address:""},message:""}),f=x(null),k=()=>{if(c.value.carts.length===0){v({style:"warning",title:"系統訊息",content:"購物車內沒有商品"});return}const b=`${w}/api/${y}/order`,a=t.value;E.post(b,{data:a}).then(n=>{p.getCart(),q.push(`/payment/${n.data.orderId}`),t.value.message="",f.value.resetForm()}).catch(n=>{v({style:"error",title:"系統訊息",content:n.response.data.message})})};return j(()=>{p.getCart()}),(b,a)=>{var h;const n=_("v-field"),r=_("error-message"),V=_("v-form");return i(),m("div",D,[O,e("div",P,[e("div",R,[e("div",z,[(i(!0),m(S,null,N(c.value.carts,s=>{var l;return i(),m("div",{key:s.id,class:"d-flex mt-2"},[e("img",{src:s==null?void 0:s.product.imageUrl,alt:"",class:"me-2",style:{width:"48px",height:"48px","object-fit":"cover"}},null,8,I),e("div",A,[e("div",G,[e("p",H,d((l=s==null?void 0:s.product)==null?void 0:l.title),1),e("p",J,"NT$"+d(s==null?void 0:s.total),1)]),e("p",K,"x"+d(s==null?void 0:s.qty),1)])])}),128)),e("table",Q,[e("tbody",null,[e("tr",null,[W,e("td",X,"NT$"+d(c.value.total),1)]),e("tr",null,[e("td",Y,[c.value.carts?(i(),m("p",Z,[ee,e("span",se,d((h=c.value.carts[0])==null?void 0:h.coupon.code),1)])):U("",!0)])])])]),e("div",te,[ae,e("p",le,"NT$"+d(c.value.final_total),1)])])]),e("div",oe,[o(V,{ref_key:"formRef",ref:f,onSubmit:k},{default:T(({errors:s})=>[ne,e("div",ce,[de,o(n,{id:"email",name:"email",type:"email",class:u(["form-control",{"is-invalid":s.email}]),placeholder:"請輸入 Email",rules:"email|required",modelValue:t.value.user.email,"onUpdate:modelValue":a[0]||(a[0]=l=>t.value.user.email=l)},null,8,["class","modelValue"]),o(r,{name:"email",class:"invalid-feedback"})]),re,e("div",ie,[me,o(n,{id:"name",name:"姓名",type:"text",class:u(["form-control",{"is-invalid":s.姓名}]),placeholder:"請輸入姓名",rules:"required",modelValue:t.value.user.name,"onUpdate:modelValue":a[1]||(a[1]=l=>t.value.user.name=l)},null,8,["class","modelValue"]),o(r,{name:"姓名",class:"invalid-feedback"})]),e("div",ue,[pe,o(n,{id:"tel",name:"電話",type:"text",class:u(["form-control",{"is-invalid":s.電話}]),placeholder:"請輸入電話",rules:"required|min:8|max:10",modelValue:t.value.user.tel,"onUpdate:modelValue":a[2]||(a[2]=l=>t.value.user.tel=l)},null,8,["class","modelValue"]),o(r,{name:"電話",class:"invalid-feedback"})]),e("div",_e,[ve,o(n,{id:"address",name:"地址",type:"text",class:u(["form-control",{"is-invalid":s.地址}]),placeholder:"請輸入地址",rules:"required",modelValue:t.value.user.address,"onUpdate:modelValue":a[3]||(a[3]=l=>t.value.user.address=l)},null,8,["class","modelValue"]),o(r,{name:"地址",class:"invalid-feedback"})]),e("div",fe,[be,M(e("textarea",{id:"message",class:"form-control",cols:"30",rows:"10","onUpdate:modelValue":a[4]||(a[4]=l=>t.value.message=l)},null,512),[[L,t.value.message]])]),he]),_:1},512)])])])}}};export{Ve as default};
