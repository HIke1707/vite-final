import{c as C,e as g,m as S,g as p,o as i,a as m,b as e,F as N,r as U,t as r,d as j,h as l,w as T,k as $,f as q,n as u,s as M,v as B}from"./index-HiRun3cb.js";import{u as E}from"./cartStores-o37m7Jpf.js";import{a as F}from"./axios-G2rPRu76.js";import{u as D}from"./toastMessage-C2r1ZJwY.js";const O={class:"container"},P=$('<div class="row justify-content-center"><div class="col-md-10"></div></div><div class="row justify-content-center"><div class="col-md-10"><h3 class="fw-bold mb-4 pt-3">Checkout</h3></div></div>',2),R={class:"row flex-row-reverse justify-content-center pb-5"},z={class:"col-md-4"},I={class:"border p-4 mb-4"},L=["src"],A={class:"w-100"},G={class:"d-flex justify-content-between"},H={class:"mb-0 fw-bold"},J={class:"mb-0"},K={class:"mb-0 fw-bold"},Q={class:"table mt-4 border-top border-bottom text-muted"},W=e("th",{scope:"row",class:"border-0 px-0 pt-4 font-weight-normal"},"total",-1),X={class:"text-end border-0 px-0 pt-4"},Y={colspan:"2"},Z={key:0},ee=e("span",null,"已套用優惠券",-1),se={class:"color-danger"},te={class:"d-flex justify-content-between mt-4"},oe=e("p",{class:"mb-0 h4 fw-bold"},"Total",-1),ae={class:"mb-0 h4 fw-bold"},le={class:"col-md-6"},ne=e("p",null,"Contact information",-1),de={class:"mb-0"},re=e("label",{for:"email",class:"form-label"},"Email",-1),ce=e("p",{class:"mt-4"},"Shipping address",-1),ie={class:"mb-2"},me=e("label",{for:"name",class:"form-label"},"收件人姓名",-1),ue={class:"mb-2"},_e=e("label",{for:"tel",class:"form-label"},"收件人電話",-1),pe={class:"mb-2"},ve=e("label",{for:"address",class:"form-label"},"收件人地址",-1),fe={class:"mb-3"},he=e("label",{for:"message",class:"form-label"},"留言",-1),be=e("div",{class:"text-end"},[e("button",{type:"submit",class:"btn btn-danger"},"送出訂單")],-1),ke={__name:"OrderPage",setup(ge){const x=D(),{pushMessage:v}=x,y="https://ec-course-api.hexschool.io/v2",w="yangapi",_=E(),d=C({get(){return _.cart}}),t=g({user:{name:"",email:"",tel:"",address:""},message:""}),f=g(null),V=()=>{if(d.value.carts.length===0){v({style:"warning",title:"系統訊息",content:"購物車內沒有商品"});return}const h=`${y}/api/${w}/order`,o=t.value;F.post(h,{data:o}).then(n=>{_.getCart(),q.push(`/payment/${n.data.orderId}`),t.value.message="",f.value.resetForm()}).catch(n=>{v({style:"error",title:"系統訊息",content:n.response.data.message})})};return S(()=>{_.getCart()}),(h,o)=>{var b;const n=p("v-field"),c=p("error-message"),k=p("v-form");return i(),m("div",O,[P,e("div",R,[e("div",z,[e("div",I,[(i(!0),m(N,null,U(d.value.carts,s=>{var a;return i(),m("div",{key:s.id,class:"d-flex mt-2"},[e("img",{src:s==null?void 0:s.product.imageUrl,alt:"",class:"me-2",style:{width:"48px",height:"48px","object-fit":"cover"}},null,8,L),e("div",A,[e("div",G,[e("p",H,r((a=s==null?void 0:s.product)==null?void 0:a.title),1),e("p",J,"NT$"+r(s==null?void 0:s.total),1)]),e("p",K,"x"+r(s==null?void 0:s.qty),1)])])}),128)),e("table",Q,[e("tbody",null,[e("tr",null,[W,e("td",X,"NT$"+r(d.value.total),1)]),e("tr",null,[e("td",Y,[d.value.carts?(i(),m("p",Z,[ee,e("span",se,r((b=d.value.carts[0])==null?void 0:b.coupon.code),1)])):j("",!0)])])])]),e("div",te,[oe,e("p",ae,"NT$"+r(d.value.final_total),1)])])]),e("div",le,[l(k,{ref_key:"formRef",ref:f,onSubmit:V},{default:T(({errors:s})=>[ne,e("div",de,[re,l(n,{id:"email",name:"email",type:"email",class:u(["form-control",{"is-invalid":s.email}]),placeholder:"請輸入 Email",rules:"email|required",modelValue:t.value.user.email,"onUpdate:modelValue":o[0]||(o[0]=a=>t.value.user.email=a)},null,8,["class","modelValue"]),l(c,{name:"email",class:"invalid-feedback"})]),ce,e("div",ie,[me,l(n,{id:"name",name:"姓名",type:"text",class:u(["form-control",{"is-invalid":s.姓名}]),placeholder:"請輸入姓名",rules:"required",modelValue:t.value.user.name,"onUpdate:modelValue":o[1]||(o[1]=a=>t.value.user.name=a)},null,8,["class","modelValue"]),l(c,{name:"姓名",class:"invalid-feedback"})]),e("div",ue,[_e,l(n,{id:"tel",name:"電話",type:"text",class:u(["form-control",{"is-invalid":s.電話}]),placeholder:"請輸入電話",rules:"required|min:8|max:10",modelValue:t.value.user.tel,"onUpdate:modelValue":o[2]||(o[2]=a=>t.value.user.tel=a)},null,8,["class","modelValue"]),l(c,{name:"電話",class:"invalid-feedback"})]),e("div",pe,[ve,l(n,{id:"address",name:"地址",type:"text",class:u(["form-control",{"is-invalid":s.地址}]),placeholder:"請輸入地址",rules:"required",modelValue:t.value.user.address,"onUpdate:modelValue":o[3]||(o[3]=a=>t.value.user.address=a)},null,8,["class","modelValue"]),l(c,{name:"地址",class:"invalid-feedback"})]),e("div",fe,[he,M(e("textarea",{id:"message",class:"form-control",cols:"30",rows:"10","onUpdate:modelValue":o[4]||(o[4]=a=>t.value.message=a)},null,512),[[B,t.value.message]])]),be]),_:1},512)])])])}}};export{ke as default};
