import{c as z,e as J,m as K,g as Q,o as C,a as O,b as e,F as Y,r as Z,t as $,j as tt,s as q,v as M,d as et,h as R,w as G}from"./index-1KU6goa1.js";import{u as ot}from"./cartStores-5ANyj1GH.js";import{a as E}from"./axios-G2rPRu76.js";import{c as I,g as st}from"./commonjsHelpers-5-cIlDoe.js";import{u as nt}from"./toastMessage-WMMOl8bO.js";function rt(t){var s=typeof t;return t!=null&&(s=="object"||s=="function")}var A=rt,at=typeof I=="object"&&I&&I.Object===Object&&I,ct=at,it=ct,dt=typeof self=="object"&&self&&self.Object===Object&&self,lt=it||dt||Function("return this")(),D=lt,ut=D,bt=function(){return ut.Date.now()},pt=bt,_t=/\s/;function ft(t){for(var s=t.length;s--&&_t.test(t.charAt(s)););return s}var ht=ft,mt=ht,gt=/^\s+/;function yt(t){return t&&t.slice(0,mt(t)+1).replace(gt,"")}var vt=yt,Tt=D,xt=Tt.Symbol,H=xt,P=H,X=Object.prototype,$t=X.hasOwnProperty,wt=X.toString,j=P?P.toStringTag:void 0;function jt(t){var s=$t.call(t,j),c=t[j];try{t[j]=void 0;var d=!0}catch{}var u=wt.call(t);return d&&(s?t[j]=c:delete t[j]),u}var St=jt,kt=Object.prototype,Ct=kt.toString;function Ot(t){return Ct.call(t)}var It=Ot,U=H,Et=St,Nt=It,Lt="[object Null]",qt="[object Undefined]",V=U?U.toStringTag:void 0;function Mt(t){return t==null?t===void 0?qt:Lt:V&&V in Object(t)?Et(t):Nt(t)}var Rt=Mt;function Gt(t){return t!=null&&typeof t=="object"}var Pt=Gt,Ut=Rt,Vt=Pt,Bt="[object Symbol]";function Ft(t){return typeof t=="symbol"||Vt(t)&&Ut(t)==Bt}var Wt=Ft,At=vt,B=A,Dt=Wt,F=NaN,Ht=/^[-+]0x[0-9a-f]+$/i,Xt=/^0b[01]+$/i,zt=/^0o[0-7]+$/i,Jt=parseInt;function Kt(t){if(typeof t=="number")return t;if(Dt(t))return F;if(B(t)){var s=typeof t.valueOf=="function"?t.valueOf():t;t=B(s)?s+"":s}if(typeof t!="string")return t===0?t:+t;t=At(t);var c=Xt.test(t);return c||zt.test(t)?Jt(t.slice(2),c?2:8):Ht.test(t)?F:+t}var Qt=Kt,Yt=A,N=pt,W=Qt,Zt="Expected a function",te=Math.max,ee=Math.min;function oe(t,s,c){var d,u,b,l,i,f,g=0,T=!1,y=!1,n=!0;if(typeof t!="function")throw new TypeError(Zt);s=W(s)||0,Yt(c)&&(T=!!c.leading,y="maxWait"in c,b=y?te(W(c.maxWait)||0,s):b,n="trailing"in c?!!c.trailing:n);function r(a){var m=d,w=u;return d=u=void 0,g=a,l=t.apply(w,m),l}function _(a){return g=a,i=setTimeout(p,s),T?r(a):l}function x(a){var m=a-f,w=a-g,L=s-m;return y?ee(L,b-w):L}function v(a){var m=a-f,w=a-g;return f===void 0||m>=s||m<0||y&&w>=b}function p(){var a=N();if(v(a))return o(a);i=setTimeout(p,x(a))}function o(a){return i=void 0,n&&d?r(a):(d=u=void 0,l)}function S(){i!==void 0&&clearTimeout(i),g=0,d=f=u=i=void 0}function k(){return i===void 0?l:o(N())}function h(){var a=N(),m=v(a);if(d=arguments,u=this,f=a,m){if(i===void 0)return _(f);if(y)return clearTimeout(i),i=setTimeout(p,s),r(f)}return i===void 0&&(i=setTimeout(p,s)),l}return h.cancel=S,h.flush=k,h}var se=oe;const ne=st(se),re={class:"container"},ae={class:"row mt-3"},ce={class:"col-8"},ie=e("h3",null,"購物車明細",-1),de={class:"table",style:{width:"100%"}},le=e("thead",null,[e("tr",null,[e("th",{scope:"col",class:"border-0 ps-0",style:{width:"50%"}},"商品名稱"),e("th",{scope:"col",class:"border-0",style:{width:"10%"}},"單件價格"),e("th",{scope:"col",class:"border-0",style:{width:"20%"}},"數量"),e("th",{scope:"col",class:"border-0",style:{width:"10%"}},"小計"),e("th",{scope:"col",class:"border-0",style:{width:"10%"}})])],-1),ue={scope:"row",class:"border-0 px-0 font-weight-normal py-4"},be={style:{width:"100%"}},pe=["src"],_e={class:"mb-0 fw-bold ms-3 d-inline-block"},fe={class:"border-0 align-middle"},he={class:"mb-0 ms-auto"},me={class:"border-0 align-middle",style:{"max-width":"160px"}},ge={class:"input-group pe-5"},ye={class:"input-group-prepend"},ve=["onClick"],Te=e("i",{class:"fas fa-minus"},null,-1),xe=[Te],$e=["onUpdate:modelValue"],we={class:"input-group-append"},je=["onClick"],Se=e("i",{class:"fas fa-plus"},null,-1),ke=[Se],Ce={class:"border-0 align-middle"},Oe={class:"mb-0 ms-auto"},Ie={class:"border-0 align-middle"},Ee=["onClick"],Ne=e("i",{class:"fas fa-times"},null,-1),Le=[Ne],qe={class:"col-md-4"},Me={class:"border p-4 mb-4"},Re=e("h4",{class:"fw-bold mb-4"},"訂單資訊",-1),Ge={class:"table text-muted border-bottom"},Pe=e("th",{scope:"row",class:"border-0 px-0 pt-4 font-weight-normal"},"總計",-1),Ue={class:"text-end border-0 px-0 pt-4"},Ve=e("tr",null,[e("th",{scope:"row",class:"border-0 px-0 pt-0 pb-4 font-weight-normal"},"運費"),e("td",{class:"text-end border-0 px-0 pt-0 pb-4"},"NT$0")],-1),Be={colspan:"2"},Fe={key:0},We=e("span",null,"已套用優惠券",-1),Ae={class:"color-danger"},De={class:"d-flex justify-content-between mt-4"},He=e("p",{class:"mb-0 h4 fw-bold"},"Total",-1),Xe={class:"mb-0 h4 fw-bold"},ze=e("a",{class:"btn btn-dark w-50 mt-4"},"返回購物",-1),Je=e("a",{class:"btn btn-dark w-50 mt-4"},"前往結賬",-1),eo={__name:"CartPage",setup(t){const s=nt(),{pushMessage:c}=s,d="https://ec-course-api.hexschool.io/v2",u="yangapi",b=ot(),l=z({get(){return b.cart}}),i=(n,r)=>{if(r==="+")n.qty=n.qty+1;else if(n.qty>1&&r==="-")n.qty=n.qty-1;else return!1;f(n.id,n.product.id,n.qty)},f=ne((n,r,_=1)=>{const x=`${d}/api/${u}/cart/${n}`,v={product_id:r,qty:_};E.put(x,{data:v}).then(p=>{c({style:"success",title:"系統訊息",content:p.data.message}),b.getCart()}).catch(p=>{c({style:"error",title:"發生錯誤",content:p.response.data.message})})},500),g=n=>{const r=`${d}/api/${u}/cart/${n}`;E.delete(r).then(_=>{c({style:"success",title:"系統訊息",content:_.data.message}),b.getCart()}).catch(_=>{c({style:"error",title:"發生錯誤",content:_.response.data.message})})},T=J(""),y=()=>{const n=`${d}/api/${u}/coupon`;E.post(n,{data:{code:T.value}}).then(r=>{c({style:"success",title:"系統訊息",content:r.data.message}),b.getCart()}).catch(r=>{c({style:"error",title:"發生錯誤",content:r.response.data.message})})};return K(()=>{b.getCart()}),(n,r)=>{var x,v,p;const _=Q("RouterLink");return C(),O("div",re,[e("div",ae,[e("div",ce,[ie,e("table",de,[le,e("tbody",null,[(C(!0),O(Y,null,Z(l.value.carts,o=>{var S,k;return C(),O("tr",{class:"border-bottom border-top",key:o.id},[e("td",ue,[e("div",be,[e("img",{src:o==null?void 0:o.product.imageUrl,alt:"",style:{width:"72px",height:"72px","object-fit":"cover"}},null,8,pe)]),e("p",_e,$((S=o==null?void 0:o.product)==null?void 0:S.title),1)]),e("td",fe,[e("p",he,$((k=o==null?void 0:o.product)==null?void 0:k.price),1)]),e("td",me,[e("div",ge,[e("div",ye,[e("button",{onClick:h=>i(o,"-"),class:"btn btn-outline-dark border-0 py-2",type:"button",id:"button-addon1"},xe,8,ve)]),q(e("input",{type:"text",class:"form-control border-0 text-center my-auto shadow-none",placeholder:"","aria-label":"Example text with button addon","aria-describedby":"button-addon1","onUpdate:modelValue":h=>o.qty=h},null,8,$e),[[M,o.qty]]),e("div",we,[e("button",{onClick:h=>i(o,"+"),class:"btn btn-outline-dark border-0 py-2",type:"button",id:"button-addon2"},ke,8,je)])])]),e("td",Ce,[e("p",Oe,$(o==null?void 0:o.total),1)]),e("td",Ie,[e("button",{onClick:h=>g(o.id),class:"btn btn-outline-dark border-0 py-2",type:"button",id:"button-addon2"},Le,8,Ee)])])}),128))])])]),e("div",qe,[e("div",Me,[Re,e("table",Ge,[e("tbody",null,[e("tr",null,[Pe,e("td",Ue,$(l.value.total),1)]),Ve,e("tr",null,[e("td",Be,[tt(" 優惠碼 : "),q(e("input",{type:"text","onUpdate:modelValue":r[0]||(r[0]=o=>T.value=o),onChange:r[1]||(r[1]=o=>y())},null,544),[[M,T.value]]),(x=l.value)!=null&&x.carts?(C(),O("p",Fe,[We,e("span",Ae,$((p=(v=l.value.carts[0])==null?void 0:v.coupon)==null?void 0:p.code),1)])):et("",!0)])])])]),e("div",De,[He,e("p",Xe,$(l.value.final_total),1)]),R(_,{to:"/products"},{default:G(()=>[ze]),_:1}),R(_,{to:"/checkout"},{default:G(()=>[Je]),_:1})])])])])}}};export{eo as default};
