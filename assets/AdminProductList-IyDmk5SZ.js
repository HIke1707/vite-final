import{o as c,a as r,F as V,b as t,j as C,t as i,r as L,d as A,s as d,z as F,e as u,m as D,q as E,v,A as j,h as N,n as I}from"./index-1KU6goa1.js";import{a as B}from"./axios-G2rPRu76.js";import{_ as J}from"./PaginationVue-rctQ98he.js";import{M as O}from"./modal-ll1wQJJH.js";import"./commonjsHelpers-5-cIlDoe.js";const z={id:"detail"},R=t("h2",null,"單一產品細節",-1),T={class:"card mb-3"},q=["src"],G={class:"card-body"},H={class:"card-title"},K={class:"badge bg-primary ms-2"},Q={class:"card-text"},W={class:"card-text"},X={class:"d-flex"},Y={class:"card-text me-2"},Z={class:"card-text text-secondary"},tt=["src"],et={class:"text-secondary"},st={__name:"ProductDetail",props:{product:{type:Object,default:()=>{}},hasFocus:{type:Boolean,default:()=>!1}},setup(l){return(U,P)=>(c(),r("div",z,[R,l.hasFocus?(c(),r(V,{key:0},[t("div",T,[t("img",{src:l.product.imageUrl,class:"card-img-top primary-image",alt:"主圖"},null,8,q),t("div",G,[t("h5",H,[C(i(l.product.title)+" ",1),t("span",K,i(l.product.category),1)]),t("p",Q,"商品描述："+i(l.product.description),1),t("p",W,"商品內容："+i(l.product.content),1),t("div",X,[t("p",Y,i(l.product.price),1),t("p",Z,[t("del",null,i(l.product.origin_price),1)]),C(" 元 / "+i(l.product.unit),1)])])]),(c(!0),r(V,null,L(l.product.imagesUrl,(p,_)=>(c(),r("img",{key:_,src:p,alt:"",class:"images m-2"},null,8,tt))),128))],64)):A("",!0),d(t("p",et,"請選擇一個商品查看",512),[[F,!l.hasFocus]])]))}},ot={id:"delProductModal",ref:"delProductModal",class:"modal fade",tabindex:"-1","aria-labelledby":"delProductModalLabel","aria-hidden":"true"},lt={class:"modal-dialog"},at={class:"modal-content border-0"},nt=t("div",{class:"modal-header bg-danger text-white"},[t("h5",{id:"delProductModalLabel",class:"modal-title"},[t("span",null,"刪除產品")]),t("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1),dt={class:"modal-body"},it=t("strong",{class:"text-danger"},null,-1),ct={class:"modal-footer"},rt=t("button",{type:"button",class:"btn btn-outline-secondary","data-bs-dismiss":"modal"}," 取消 ",-1),ut={__name:"DeleteProductModal",props:{propitem:null},emits:["close"],setup(l,{expose:U,emit:P}){const p="https://ec-course-api.hexschool.io/v2",_="yangapi",f=l,o=P,h=u(null),m=()=>{h.value.show()},x=()=>{h.value.hide()},g=async()=>{const y=f.propitem.id,$=`${p}/api/${_}/admin/product/${y}`;let b=!1;return await B.delete($).then(w=>{const{success:k}=w.data;b=k,alert("已刪除商品"),x(),o("close")}).catch(w=>{alert(JSON.stringify(w))}),b};return D(async()=>{h.value=new O(document.getElementById("delProductModal"),{keyboard:!1})}),U({openModal:m,hideModal:x}),(y,$)=>(c(),r("div",ot,[t("div",lt,[t("div",at,[nt,t("div",dt,[C(" 是否刪除 "),it,C(" 商品"+i(l.propitem.title)+"(刪除後將無法恢復)。 ",1)]),t("div",ct,[rt,t("button",{type:"button",class:"btn btn-danger",onClick:$[0]||($[0]=b=>g())}," 確認刪除 ")])])])],512))}},mt={id:"product-modal",class:"modal fade",tabindex:"-1","aria-labelledby":"productModalLabel","aria-hidden":"true"},pt={class:"modal-dialog modal-xl"},_t={class:"modal-content border-0"},ht={class:"modal-header bg-dark text-white"},bt={id:"productModalLabel",class:"modal-title"},vt=t("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"},null,-1),ft={class:"modal-body"},gt={class:"row"},yt={class:"col-sm-4"},$t={class:"mb-2"},wt={class:"mb-3"},xt=t("label",{for:"imageUrl",class:"form-label"},"輸入圖片網址",-1),kt=["src"],Mt={key:0},Ut=["src"],Pt=["onUpdate:modelValue"],Ct={key:1},Vt={class:"col-sm-8"},Nt={class:"mb-3"},Bt=t("label",{for:"title",class:"form-label"},"標題",-1),Ft={class:"row"},Lt={class:"mb-3 col-md-6"},Dt=t("label",{for:"category",class:"form-label"},"分類",-1),Ot={class:"mb-3 col-md-6"},St=t("label",{for:"price",class:"form-label"},"單位",-1),At={class:"row"},Et={class:"mb-3 col-md-6"},jt=t("label",{for:"origin_price",class:"form-label"},"原價",-1),It={class:"mb-3 col-md-6"},Jt=t("label",{for:"price",class:"form-label"},"售價",-1),zt=t("hr",null,null,-1),Rt={class:"mb-3"},Tt=t("label",{for:"description",class:"form-label"},"產品描述",-1),qt={class:"mb-3"},Gt=t("label",{for:"content",class:"form-label"},"說明內容",-1),Ht={class:"mb-3"},Kt={class:"form-check"},Qt=t("label",{class:"form-check-label",for:"is_enabled"},"是否啟用",-1),Wt={__name:"ProductModal",props:["isopen","isnew","propitem"],emits:["close"],setup(l,{expose:U,emit:P}){const p="https://ec-course-api.hexschool.io/v2",_="yangapi",f=l,o=u(f.propitem),h=P,m=u(null),x=()=>{m.value.show()},g=()=>{m.value.hide()},y=async()=>{const a=`${p}/api/${_}/admin/product`;let s=!1;const e={data:o.value};return await B.post(a,e).then(n=>{const{success:M}=n.data;s=M}).catch(n=>{alert(JSON.stringify(n))}),s},$=async()=>{const a=`${p}/api/${_}/admin/product/${o.value.id}`;let s=!1;const e={data:o.value};return await B.put(a,e).then(n=>{const{success:M}=n.data;s=M}).catch(n=>{alert(JSON.stringify(n))}),s},b=async()=>{let a=!1;return a=f.isnew?await y():await $(),h("close"),g(),a},w=()=>{g()},k=()=>{o.value.imagesUrl=[],o.value.imagesUrl.push("")};return E(()=>f.propitem,a=>{o.value=a}),D(async()=>{m.value=new O(document.getElementById("product-modal"),{keyboard:!1})}),U({openModal:x,hideModal:g}),(a,s)=>(c(),r("div",mt,[t("div",pt,[t("div",_t,[t("div",ht,[t("h5",bt,[t("span",null,i(l.isnew?"新增產品":"編輯產品"),1)]),vt]),t("div",ft,[t("div",gt,[t("div",yt,[t("div",$t,[t("div",wt,[xt,d(t("input",{type:"text",class:"form-control",placeholder:"請輸入圖片連結","onUpdate:modelValue":s[0]||(s[0]=e=>o.value.imageUrl=e)},null,512),[[v,o.value.imageUrl]])]),t("img",{class:"img-fluid",src:o.value.imageUrl,alt:""},null,8,kt)]),Array.isArray(o.value.imagesUrl)?(c(),r("div",Mt,[(c(!0),r(V,null,L(o.value.imagesUrl,(e,n)=>(c(),r("div",{key:n},[t("img",{class:"img-fluid",src:e,alt:""},null,8,Ut),d(t("input",{type:"text",class:"form-control","onUpdate:modelValue":M=>o.value.imagesUrl[n]=M},null,8,Pt),[[v,o.value.imagesUrl[n]]])]))),128)),t("div",null,[t("button",{class:"btn btn-outline-primary btn-sm d-block w-100",onClick:s[1]||(s[1]=e=>o.value.imagesUrl.push(""))}," 新增圖片 ")]),t("div",null,[t("button",{class:"btn btn-outline-danger btn-sm d-block w-100",onClick:s[2]||(s[2]=e=>o.value.imagesUrl.pop())}," 刪除圖片 ")])])):(c(),r("div",Ct,[t("button",{class:"btn btn-outline-primary btn-sm d-block w-100",onClick:k}," 新增圖片 ")]))]),t("div",Vt,[t("div",Nt,[Bt,d(t("input",{id:"title",type:"text",class:"form-control",placeholder:"請輸入標題","onUpdate:modelValue":s[3]||(s[3]=e=>o.value.title=e)},null,512),[[v,o.value.title]])]),t("div",Ft,[t("div",Lt,[Dt,d(t("input",{id:"category",type:"text",class:"form-control",placeholder:"請輸入分類","onUpdate:modelValue":s[4]||(s[4]=e=>o.value.category=e)},null,512),[[v,o.value.category]])]),t("div",Ot,[St,d(t("input",{id:"unit",type:"text",class:"form-control",placeholder:"請輸入單位","onUpdate:modelValue":s[5]||(s[5]=e=>o.value.unit=e)},null,512),[[v,o.value.unit]])])]),t("div",At,[t("div",Et,[jt,d(t("input",{id:"origin_price",type:"number",min:"0",class:"form-control",placeholder:"請輸入原價","onUpdate:modelValue":s[6]||(s[6]=e=>o.value.origin_price=e)},null,512),[[v,o.value.origin_price,void 0,{number:!0}]])]),t("div",It,[Jt,d(t("input",{id:"price",type:"number",min:"0",class:"form-control",placeholder:"請輸入售價","onUpdate:modelValue":s[7]||(s[7]=e=>o.value.price=e)},null,512),[[v,o.value.price,void 0,{number:!0}]])])]),zt,t("div",Rt,[Tt,d(t("textarea",{id:"description",type:"text",class:"form-control",placeholder:"請輸入產品描述","onUpdate:modelValue":s[8]||(s[8]=e=>o.value.content=e)},`
                `,512),[[v,o.value.content]])]),t("div",qt,[Gt,d(t("textarea",{id:"description",type:"text",class:"form-control",placeholder:"請輸入說明內容","onUpdate:modelValue":s[9]||(s[9]=e=>o.value.description=e)},`
                `,512),[[v,o.value.description]])]),t("div",Ht,[t("div",Kt,[d(t("input",{id:"is_enabled",class:"form-check-input",type:"checkbox","true-value":1,"false-value":0,"onUpdate:modelValue":s[10]||(s[10]=e=>o.value.is_enabled=e)},null,512),[[j,o.value.is_enabled]]),Qt])])])])]),t("div",{class:"modal-footer"},[t("button",{type:"button",class:"btn btn-outline-secondary","data-bs-dismiss":"modal",onClick:w}," 取消 "),t("button",{type:"button",class:"btn btn-primary",onClick:b}," 確認 ")])])])]))}},Xt={class:"container"},Yt={class:"row py-3"},Zt={class:"col-md-6"},te={class:"row"},ee=t("div",{class:"col-md-6"},[t("h2",{class:"w50"},"產品列表")],-1),se={class:"col-md-6"},oe={class:"table table-hover mt-4"},le=t("thead",null,[t("tr",null,[t("th",{width:"150"},"產品名稱"),t("th",{width:"120"}," 原價 "),t("th",{width:"120"}," 售價 "),t("th",{width:"140"}," 是否啟用 "),t("th",{width:"140"}," 查看細節 "),t("th",{width:"180"}," 動作 ")])],-1),ae={width:"150"},ne={width:"120"},de={width:"120"},ie={width:"140"},ce={class:"text-success"},re={width:"140"},ue=["onClick"],me={width:"200"},pe=["onClick"],_e=["onClick"],he={class:"col-md-6"},$e={__name:"AdminProductList",setup(l){const U="https://ec-course-api.hexschool.io/v2",P="yangapi",p=u([]),_=u(null),f=u(!1),o=u(!1),h=u(!1),m=u({imagesUrl:[]}),x=u({}),g=u(null),y=u(null),$=a=>{_.value=a,f.value=!0},b=async(a=1)=>{const s=`${U}/api/${P}/admin/products?page=${a}`;await B.get(s).then(e=>{const n=e.data.products;p.value=Object.entries(n).map(([M,S])=>({id:M,...S})),x.value=e.data.pagination}).catch(e=>{console.debug(e)})},w=()=>{o.value=!1,b()},k=(a,s)=>{a==="new"?(m.value={imagesUrl:[]},h.value=!0,y.value.openModal()):a==="edit"?(m.value={...s},h.value=!1,y.value.openModal()):a==="delete"&&(m.value={...s},g.value.openModal())};return D(()=>{b()}),(a,s)=>(c(),r(V,null,[t("div",Xt,[t("div",Yt,[t("div",Zt,[t("div",te,[ee,t("div",se,[t("button",{type:"button",class:"btn btn-primary","data-bs-toggle":"modal","data-bs-target":"#product-modal",style:{float:"right"},onClick:s[0]||(s[0]=e=>k("new",null))},"新增項目")])]),t("table",oe,[le,t("tbody",null,[(c(!0),r(V,null,L(p.value,e=>(c(),r("tr",{key:e.id,class:I([{"table-secondary":!e.is_enabled}])},[t("td",ae,i(e.title),1),t("td",ne,i(e.origin_price),1),t("td",de,i(e.price),1),t("td",ie,[d(t("span",ce,"啟用",512),[[F,e.is_enabled]]),d(t("span",null,"未啟用",512),[[F,!e.is_enabled]])]),t("td",re,[t("button",{type:"button",class:"btn btn-primary",onClick:n=>$(e)},"查看細節",8,ue)]),t("td",me,[t("button",{type:"button",class:"btn btn-primary",onClick:n=>k("delete",e)},"刪除",8,pe),t("button",{type:"button",class:"btn btn-primary",onClick:n=>k("edit",e)},"編輯",8,_e)])],2))),128))])]),N(J,{pages:x.value,onEmitPages:b},null,8,["pages"]),t("p",null,[C("目前有 "),t("span",null,i(p.value.length),1),C(" 項產品")])]),t("div",he,[N(st,{product:_.value,"has-focus":f.value},null,8,["product","has-focus"])])])]),N(Wt,{isnew:h.value,propitem:m.value,onClose:w,ref_key:"productModalRef",ref:y},null,8,["isnew","propitem"]),N(ut,{propitem:m.value,onClose:w,ref_key:"delProductModal",ref:g},null,8,["propitem"])],64))}};export{$e as default};
